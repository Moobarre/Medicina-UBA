<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malla Curricular Medicina</title>
  <style>
    body {
      font-family: 'Nunito', sans-serif;
      background-color: #f4f4f4;
      padding: 20px;
    }
    h1, h2 {
      font-family: 'Righteous', cursive;
      color: #7A8450;
      text-align: center;
    }
    .grid {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }
    .column {
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      padding: 15px;
      width: 280px;
    }
    .subject {
      padding: 10px;
      border: 2px solid #ccc;
      border-radius: 8px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: 0.2s;
    }
    .subject:hover {
      background-color: #f9f9f9;
    }
    .approved {
      background-color: #C66F80;
      color: white;
    }
    .regular {
      background-color: #7A8450;
      color: white;
    }
    .disabled {
      opacity: 0.4;
      cursor: not-allowed;
      pointer-events: auto;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Medicina</h1>
  <div class="grid" id="malla"></div>

  <script>
    const data = {
      "AÑO 1: CBC": [
        "Introducción al Pensamiento Científico",
        "Introducción al Conocimiento de la Sociedad y Estado",
        "Química",
        "Fisica e Introduccion a la biofisica",
        "Biologia e Introduccion a la Biología Celular",
        "Matemática"
      ],
      "AÑO 2: CICLO BIOMÉDICO": [
        { name: "Anatomia", requires: ["CBC"] },
        { name: "Histología", requires: ["CBC"] },
        { name: "Embriologia", requires: ["CBC"] },
        { name: "Biología Molecular y Genética", requires: ["CBC"] },
        { name: "Salud Mental", requires: ["CBC"] },
        { name: "Salud Pública", requires: ["CBC"] },
        { name: "Bioética", requires: ["CBC"] },
        { name: "Curso de Inglés para Ciencias de la Salud", requires: ["CBC"] }
      ],
      "AÑO 3: CICLO BIOMÉDICO": [
        { name: "Fisiologia y Biofisica", requires: ["Anatomia", "Histología", "Embriologia", "Biología Molecular y Genética"] },
        { name: "Bioquímica", requires: ["Anatomia", "Histología", "Embriologia", "Biología Molecular y Genética"] },
        { name: "Inmunologia humana", requires: ["Anatomia", "Histología", "Embriologia", "Biología Molecular y Genética"] },
        { name: "Microbiologia y Parasitologia", requires: ["Inmunologia humana", "Bioquímica"] }
      ],
      "CICLO CLÍNICO - MEDICINA": [
        { name: "Medicina I", requires: ["AÑO 3: CICLO BIOMÉDICO"] },
        { name: "Patología", requires: ["AÑO 3: CICLO BIOMÉDICO"] },
        { name: "Farmacología I", requires: ["AÑO 3: CICLO BIOMÉDICO"] },
        { name: "Medicina II", requires: ["Medicina I", "Patología"] },
        { name: "Diagnóstico por imágenes", requires: ["Medicina I", "Patología"] },
        { name: "Nutrición", requires: ["Medicina I", "Patología"] },
        { name: "Dermatología", requires: ["Medicina I", "Patología"] },
        { name: "Infectología", requires: ["Medicina I", "Patología"] },
        { name: "Neumología", requires: ["Medicina I", "Patología"] },
        { name: "Neurología", requires: ["Medicina I", "Patología"] }
      ],
      "CICLO CLÍNICO - CIRUGÍA": [
        { name: "Cirugía general", requires: ["Medicina I", "Patología"] },
        { name: "Urología", requires: ["Medicina I", "Patología"] },
        { name: "Traumatología y Ortopedia", requires: ["Medicina I", "Patología"] },
        { name: "Oftalmología", requires: ["Medicina I", "Patología"] },
        { name: "Otorrinolaringología", requires: ["Medicina I", "Patología"] },
        { name: "Neurocirugía", requires: ["Medicina I", "Patología"] }
      ],
      "CICLO CLÍNICO - TOCOGINECOLOGÍA": [
        { name: "Obstetricia", requires: ["Medicina I", "Patología"] },
        { name: "Ginecología", requires: ["Medicina I", "Patología"] },
        { name: "Pediatría", requires: ["Medicina I", "Patología"] },
        { name: "Farmacología II", requires: ["Medicina I", "Patología"] },
        { name: "Psiquiatría", requires: ["Medicina I", "Patología"] },
        { name: "Toxicología", requires: ["Medicina I", "Patología"] },
        { name: "Medicina Legal y Deontología Médica", requires: ["Medicina I", "Patología"] }
      ]
    };

    const state = JSON.parse(localStorage.getItem("malla")) || {};

    function saveState() {
      localStorage.setItem("malla", JSON.stringify(state));
    }

    function isApproved(name) {
      return state[name] === "aprobado";
    }

    function isRegular(name) {
      return state[name] === "regular";
    }

    function render() {
      const container = document.getElementById("malla");
      container.innerHTML = "";

      for (const [column, subjects] of Object.entries(data)) {
        const col = document.createElement("div");
        col.className = "column";

        const title = document.createElement("h2");
        title.innerText = column;
        col.appendChild(title);

        for (let subj of subjects) {
          let name = typeof subj === "string" ? subj : subj.name;
          let requirements = typeof subj === "string" ? [] : subj.requires;

          const div = document.createElement("div");
          div.className = "subject";
          div.innerText = name;

          if (isApproved(name)) div.classList.add("approved");
          else if (isRegular(name)) div.classList.add("regular");

          const met = requirements.every(r => isApproved(r) || (r.includes("CBC") && allCbcApproved()));

          if (!met) {
            div.classList.add("disabled");
            div.title = "Requiere: " + requirements.join(", ");
          } else {
            div.addEventListener("click", () => {
              if (!state[name]) state[name] = "regular";
              else if (state[name] === "regular") state[name] = "aprobado";
              else delete state[name];
              saveState();
              render();
            });
          }

          col.appendChild(div);
        }

        container.appendChild(col);
      }
    }

    function allCbcApproved() {
      return data["AÑO 1: CBC"].every(m => isApproved(m));
    }

    render();
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Nunito&family=Righteous&display=swap" rel="stylesheet">
</body>
</html>
